/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { NotificationsService, NotificationType } from 'angular2-notifications';
import { forkJoin, Observable } from 'rxjs';
import { TranslateService } from '@ngx-translate/core';
import { NavigationEnd, Router } from '@angular/router';
import { filter } from 'rxjs/operators';
/** @type {?} */
var i18nPrefix = 'i18n.fx-components.notification.';
/** @type {?} */
var configurations = {
    error: {
        timeOut: 5000
    },
    warn: {
        timeOut: 5000
    },
    info: {
        timeOut: 3000
    },
    success: {
        timeOut: 3000
    }
};
var FxNotificationService = /** @class */ (function () {
    function FxNotificationService(notifications, translate, router) {
        var _this = this;
        this.notifications = notifications;
        this.translate = translate;
        this.errorNotifications = [];
        router.events
            .pipe(filter((/**
         * @param {?} event
         * @return {?}
         */
        function (event) { return event instanceof NavigationEnd; })))
            .subscribe((/**
         * @return {?}
         */
        function () {
            _this.errorNotifications.forEach((/**
             * @param {?} notification
             * @return {?}
             */
            function (notification) {
                return notifications.remove(notification.id);
            }));
            _this.errorNotifications = [];
        }));
    }
    /**
     * @param {?} messageType
     * @return {?}
     */
    FxNotificationService.prototype.error = /**
     * @param {?} messageType
     * @return {?}
     */
    function (messageType) {
        var _this = this;
        this.create(NotificationType.Error, messageType)
            .subscribe((/**
         * @param {?} notification
         * @return {?}
         */
        function (notification) {
            return _this.errorNotifications.push(notification);
        }));
    };
    /**
     * @param {?} messageType
     * @return {?}
     */
    FxNotificationService.prototype.warn = /**
     * @param {?} messageType
     * @return {?}
     */
    function (messageType) {
        this.create(NotificationType.Warn, messageType).subscribe();
    };
    /**
     * @param {?} messageType
     * @return {?}
     */
    FxNotificationService.prototype.info = /**
     * @param {?} messageType
     * @return {?}
     */
    function (messageType) {
        this.create(NotificationType.Info, messageType).subscribe();
    };
    /**
     * @param {?} messageType
     * @return {?}
     */
    FxNotificationService.prototype.success = /**
     * @param {?} messageType
     * @return {?}
     */
    function (messageType) {
        this.create(NotificationType.Success, messageType).subscribe();
    };
    /**
     * @param {?} statusCode
     * @param {?=} statusCodeDescriptionsType
     * @return {?}
     */
    FxNotificationService.prototype.httpError = /**
     * @param {?} statusCode
     * @param {?=} statusCodeDescriptionsType
     * @return {?}
     */
    function (statusCode, statusCodeDescriptionsType) {
        if (!statusCodeDescriptionsType) {
            statusCodeDescriptionsType = 'default';
        }
        /** @type {?} */
        var titleObservable = this.translateMessage(NotificationType.Error, 'type');
        /** @type {?} */
        var errorMessageObservable = this.translateMessage(NotificationType.Error, 'http.' + statusCodeDescriptionsType + '.' + statusCode);
        this.generateNotification(NotificationType.Error, titleObservable, errorMessageObservable).subscribe();
    };
    /**
     * @private
     * @param {?} type
     * @param {?} messageType
     * @return {?}
     */
    FxNotificationService.prototype.create = /**
     * @private
     * @param {?} type
     * @param {?} messageType
     * @return {?}
     */
    function (type, messageType) {
        /** @type {?} */
        var titleObservable = this.translateMessage(type, messageType + '.title');
        /** @type {?} */
        var messageObservable = this.translateMessage(type, messageType + '.message');
        return this.generateNotification(type, titleObservable, messageObservable);
    };
    /**
     * @private
     * @param {?} type
     * @param {?} titleObservable
     * @param {?} messageObservable
     * @return {?}
     */
    FxNotificationService.prototype.generateNotification = /**
     * @private
     * @param {?} type
     * @param {?} titleObservable
     * @param {?} messageObservable
     * @return {?}
     */
    function (type, titleObservable, messageObservable) {
        var _this = this;
        return new Observable((/**
         * @param {?} observer
         * @return {?}
         */
        function (observer) {
            forkJoin([titleObservable, messageObservable]).subscribe((/**
             * @param {?} result
             * @return {?}
             */
            function (result) {
                /** @type {?} */
                var title = result[0];
                /** @type {?} */
                var message = result[1];
                /** @type {?} */
                var notification = _this.notifications.create(title, message, type, configurations[type]);
                observer.next(notification);
                observer.complete();
            }));
        }));
    };
    /**
     * @private
     * @param {?} type
     * @param {?} i18nMessage
     * @return {?}
     */
    FxNotificationService.prototype.translateMessage = /**
     * @private
     * @param {?} type
     * @param {?} i18nMessage
     * @return {?}
     */
    function (type, i18nMessage) {
        return this.translate.get(i18nPrefix + type + '.' + i18nMessage);
    };
    FxNotificationService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    FxNotificationService.ctorParameters = function () { return [
        { type: NotificationsService },
        { type: TranslateService },
        { type: Router }
    ]; };
    return FxNotificationService;
}());
export { FxNotificationService };
if (false) {
    /** @type {?} */
    FxNotificationService.prototype.errorNotifications;
    /**
     * @type {?}
     * @private
     */
    FxNotificationService.prototype.notifications;
    /**
     * @type {?}
     * @private
     */
    FxNotificationService.prototype.translate;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZngtbm90aWZpY2F0aW9uLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZngtbGliL2NvbXBvbmVudHMvIiwic291cmNlcyI6WyJsaWIvZngtbm90aWZpY2F0aW9uL2Z4LW5vdGlmaWNhdGlvbi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFBO0FBQzFDLE9BQU8sRUFBZ0Isb0JBQW9CLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQTtBQUM3RixPQUFPLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBWSxNQUFNLE1BQU0sQ0FBQTtBQUNyRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQTtBQUN0RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sRUFBRSxNQUFNLGlCQUFpQixDQUFBO0FBQ3ZELE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQTs7SUFFakMsVUFBVSxHQUFHLGtDQUFrQzs7SUFFL0MsY0FBYyxHQUFHO0lBQ3JCLEtBQUssRUFBRTtRQUNMLE9BQU8sRUFBRSxJQUFJO0tBQ2Q7SUFDRCxJQUFJLEVBQUU7UUFDSixPQUFPLEVBQUUsSUFBSTtLQUNkO0lBQ0QsSUFBSSxFQUFFO1FBQ0osT0FBTyxFQUFFLElBQUk7S0FDZDtJQUNELE9BQU8sRUFBRTtRQUNQLE9BQU8sRUFBRSxJQUFJO0tBQ2Q7Q0FDRjtBQUVEO0lBS0UsK0JBQW9CLGFBQW1DLEVBQzdDLFNBQTJCLEVBQ25DLE1BQWM7UUFGaEIsaUJBY0M7UUFkbUIsa0JBQWEsR0FBYixhQUFhLENBQXNCO1FBQzdDLGNBQVMsR0FBVCxTQUFTLENBQWtCO1FBSDlCLHVCQUFrQixHQUFtQixFQUFFLENBQUE7UUFLNUMsTUFBTSxDQUFDLE1BQU07YUFDVixJQUFJLENBQ0gsTUFBTTs7OztRQUFDLFVBQUEsS0FBSyxJQUFJLE9BQUEsS0FBSyxZQUFZLGFBQWEs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LEtBQUssRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDMUYsUUFBUSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQTtnQkFDM0IsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFBO1lBQ3JCLENBQUMsRUFBQyxDQUFBO1FBRUosQ0FBQyxFQUFDLENBQUE7SUFDSixDQUFDOzs7Ozs7O0lBRU8sZ0RBQWdCOzs7Ozs7SUFBeEIsVUFBeUIsSUFBc0IsRUFBRSxXQUFtQjtRQUNsRSxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLFVBQVUsR0FBRyxJQUFJLEdBQUcsR0FBRyxHQUFHLFdBQVcsQ0FBQyxDQUFBO0lBQ2xFLENBQUM7O2dCQXpFRixVQUFVOzs7O2dCQXZCWSxvQkFBb0I7Z0JBRWxDLGdCQUFnQjtnQkFDRCxNQUFNOztJQThGOUIsNEJBQUM7Q0FBQSxBQTFFRCxJQTBFQztTQXpFWSxxQkFBcUI7OztJQUVoQyxtREFBOEM7Ozs7O0lBRWxDLDhDQUEyQzs7Ozs7SUFDckQsMENBQW1DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnXHJcbmltcG9ydCB7IE5vdGlmaWNhdGlvbiwgTm90aWZpY2F0aW9uc1NlcnZpY2UsIE5vdGlmaWNhdGlvblR5cGUgfSBmcm9tICdhbmd1bGFyMi1ub3RpZmljYXRpb25zJ1xyXG5pbXBvcnQgeyBmb3JrSm9pbiwgT2JzZXJ2YWJsZSwgT2JzZXJ2ZXIgfSBmcm9tICdyeGpzJ1xyXG5pbXBvcnQgeyBUcmFuc2xhdGVTZXJ2aWNlIH0gZnJvbSAnQG5neC10cmFuc2xhdGUvY29yZSdcclxuaW1wb3J0IHsgTmF2aWdhdGlvbkVuZCwgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJ1xyXG5pbXBvcnQgeyBmaWx0ZXIgfSBmcm9tICdyeGpzL29wZXJhdG9ycydcclxuXHJcbmNvbnN0IGkxOG5QcmVmaXggPSAnaTE4bi5meC1jb21wb25lbnRzLm5vdGlmaWNhdGlvbi4nXHJcblxyXG5jb25zdCBjb25maWd1cmF0aW9ucyA9IHtcclxuICBlcnJvcjoge1xyXG4gICAgdGltZU91dDogNTAwMFxyXG4gIH0sXHJcbiAgd2Fybjoge1xyXG4gICAgdGltZU91dDogNTAwMFxyXG4gIH0sXHJcbiAgaW5mbzoge1xyXG4gICAgdGltZU91dDogMzAwMFxyXG4gIH0sXHJcbiAgc3VjY2Vzczoge1xyXG4gICAgdGltZU91dDogMzAwMFxyXG4gIH1cclxufVxyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgRnhOb3RpZmljYXRpb25TZXJ2aWNlIHtcclxuXHJcbiAgcHVibGljIGVycm9yTm90aWZpY2F0aW9uczogTm90aWZpY2F0aW9uW10gPSBbXVxyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG5vdGlmaWNhdGlvbnM6IE5vdGlmaWNhdGlvbnNTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSB0cmFuc2xhdGU6IFRyYW5zbGF0ZVNlcnZpY2UsXHJcbiAgICByb3V0ZXI6IFJvdXRlcikge1xyXG4gICAgcm91dGVyLmV2ZW50c1xyXG4gICAgICAucGlwZShcclxuICAgICAgICBmaWx0ZXIoZXZlbnQgPT4gZXZlbnQgaW5zdGFuY2VvZiBOYXZpZ2F0aW9uRW5kKVxyXG4gICAgICApXHJcbiAgICAgIC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuZXJyb3JOb3RpZmljYXRpb25zLmZvckVhY2goKG5vdGlmaWNhdGlvbjogTm90aWZpY2F0aW9uKSA9PlxyXG4gICAgICAgICAgbm90aWZpY2F0aW9ucy5yZW1vdmUobm90aWZpY2F0aW9uLmlkKVxyXG4gICAgICAgIClcclxuICAgICAgICB0aGlzLmVycm9yTm90aWZpY2F0aW9ucyA9IFtdXHJcbiAgICAgIH0pXHJcblxyXG4gIH1cclxuXHJcbiAgcHVibGljIGVycm9yKG1lc3NhZ2VUeXBlOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMuY3JlYXRlKE5vdGlmaWNhdGlvblR5cGUuRXJyb3IsIG1lc3NhZ2VUeXBlKVxyXG4gICAgICAuc3Vic2NyaWJlKChub3RpZmljYXRpb246IE5vdGlmaWNhdGlvbikgPT5cclxuICAgICAgICB0aGlzLmVycm9yTm90aWZpY2F0aW9ucy5wdXNoKG5vdGlmaWNhdGlvbilcclxuICAgICAgKVxyXG4gIH1cclxuXHJcbiAgcHVibGljIHdhcm4obWVzc2FnZVR5cGU6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgdGhpcy5jcmVhdGUoTm90aWZpY2F0aW9uVHlwZS5XYXJuLCBtZXNzYWdlVHlwZSkuc3Vic2NyaWJlKClcclxuICB9XHJcblxyXG4gIHB1YmxpYyBpbmZvKG1lc3NhZ2VUeXBlOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMuY3JlYXRlKE5vdGlmaWNhdGlvblR5cGUuSW5mbywgbWVzc2FnZVR5cGUpLnN1YnNjcmliZSgpXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3VjY2VzcyhtZXNzYWdlVHlwZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICB0aGlzLmNyZWF0ZShOb3RpZmljYXRpb25UeXBlLlN1Y2Nlc3MsIG1lc3NhZ2VUeXBlKS5zdWJzY3JpYmUoKVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGh0dHBFcnJvcihzdGF0dXNDb2RlOiBudW1iZXIsIHN0YXR1c0NvZGVEZXNjcmlwdGlvbnNUeXBlPzogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBpZiAoIXN0YXR1c0NvZGVEZXNjcmlwdGlvbnNUeXBlKSB7XHJcbiAgICAgIHN0YXR1c0NvZGVEZXNjcmlwdGlvbnNUeXBlID0gJ2RlZmF1bHQnXHJcbiAgICB9XHJcbiAgICBjb25zdCB0aXRsZU9ic2VydmFibGUgPSB0aGlzLnRyYW5zbGF0ZU1lc3NhZ2UoTm90aWZpY2F0aW9uVHlwZS5FcnJvciwgJ3R5cGUnKVxyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlT2JzZXJ2YWJsZSA9IHRoaXMudHJhbnNsYXRlTWVzc2FnZShOb3RpZmljYXRpb25UeXBlLkVycm9yLCAnaHR0cC4nICsgc3RhdHVzQ29kZURlc2NyaXB0aW9uc1R5cGUgKyAnLicgKyBzdGF0dXNDb2RlKVxyXG4gICAgdGhpcy5nZW5lcmF0ZU5vdGlmaWNhdGlvbihOb3RpZmljYXRpb25UeXBlLkVycm9yLCB0aXRsZU9ic2VydmFibGUsIGVycm9yTWVzc2FnZU9ic2VydmFibGUpLnN1YnNjcmliZSgpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNyZWF0ZSh0eXBlOiBOb3RpZmljYXRpb25UeXBlLCBtZXNzYWdlVHlwZTogc3RyaW5nKTogT2JzZXJ2YWJsZTxOb3RpZmljYXRpb24+IHtcclxuICAgIGNvbnN0IHRpdGxlT2JzZXJ2YWJsZTogT2JzZXJ2YWJsZTxzdHJpbmc+ID0gdGhpcy50cmFuc2xhdGVNZXNzYWdlKHR5cGUsIG1lc3NhZ2VUeXBlICsgJy50aXRsZScpXHJcbiAgICBjb25zdCBtZXNzYWdlT2JzZXJ2YWJsZTogT2JzZXJ2YWJsZTxzdHJpbmc+ID0gdGhpcy50cmFuc2xhdGVNZXNzYWdlKHR5cGUsIG1lc3NhZ2VUeXBlICsgJy5tZXNzYWdlJylcclxuICAgIHJldHVybiB0aGlzLmdlbmVyYXRlTm90aWZpY2F0aW9uKHR5cGUsIHRpdGxlT2JzZXJ2YWJsZSwgbWVzc2FnZU9ic2VydmFibGUpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdlbmVyYXRlTm90aWZpY2F0aW9uKFxyXG4gICAgdHlwZTogTm90aWZpY2F0aW9uVHlwZSwgdGl0bGVPYnNlcnZhYmxlOiBPYnNlcnZhYmxlPHN0cmluZz4sIG1lc3NhZ2VPYnNlcnZhYmxlOiBPYnNlcnZhYmxlPHN0cmluZz4pOiBPYnNlcnZhYmxlPE5vdGlmaWNhdGlvbj4ge1xyXG4gICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKChvYnNlcnZlcjogT2JzZXJ2ZXI8Tm90aWZpY2F0aW9uPikgPT4ge1xyXG5cclxuICAgICAgZm9ya0pvaW4oW3RpdGxlT2JzZXJ2YWJsZSwgbWVzc2FnZU9ic2VydmFibGVdKS5zdWJzY3JpYmUoKHJlc3VsdDogc3RyaW5nW10pID0+IHtcclxuICAgICAgICBjb25zdCB0aXRsZTogc3RyaW5nID0gcmVzdWx0WzBdXHJcbiAgICAgICAgY29uc3QgbWVzc2FnZTogc3RyaW5nID0gcmVzdWx0WzFdXHJcblxyXG4gICAgICAgIGNvbnN0IG5vdGlmaWNhdGlvbiA9IHRoaXMubm90aWZpY2F0aW9ucy5jcmVhdGUodGl0bGUsIG1lc3NhZ2UsIHR5cGUsIGNvbmZpZ3VyYXRpb25zW3R5cGVdKVxyXG4gICAgICAgIG9ic2VydmVyLm5leHQobm90aWZpY2F0aW9uKVxyXG4gICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKClcclxuICAgICAgfSlcclxuXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB0cmFuc2xhdGVNZXNzYWdlKHR5cGU6IE5vdGlmaWNhdGlvblR5cGUsIGkxOG5NZXNzYWdlOiBzdHJpbmcpOiBPYnNlcnZhYmxlPHN0cmluZz4ge1xyXG4gICAgcmV0dXJuIHRoaXMudHJhbnNsYXRlLmdldChpMThuUHJlZml4ICsgdHlwZSArICcuJyArIGkxOG5NZXNzYWdlKVxyXG4gIH1cclxufVxyXG4iXX0=