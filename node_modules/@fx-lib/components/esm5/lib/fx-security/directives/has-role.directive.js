/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectorRef, Directive, Input, TemplateRef, ViewContainerRef } from '@angular/core';
import { AuthenticationService } from '../services/authentication.service';
import { AuthorizationService } from '../services/authorization.service';
var HasRoleDirective = /** @class */ (function () {
    function HasRoleDirective(_viewContainer, templateRef, authService, authorizationService, changeDetector) {
        var _this = this;
        this._viewContainer = _viewContainer;
        this.authorizationService = authorizationService;
        this.changeDetector = changeDetector;
        this._context = new HasRoleContext();
        this._thenTemplateRef = null;
        this._elseTemplateRef = null;
        this._thenViewRef = null;
        this._elseViewRef = null;
        this._thenTemplateRef = templateRef;
        this.loginEventsSubscription = authService.loginEvents.subscribe((/**
         * @return {?}
         */
        function () {
            _this._updateView();
            _this.changeDetector.markForCheck();
        }));
    }
    /**
     * @return {?}
     */
    HasRoleDirective.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.loginEventsSubscription) {
            this.loginEventsSubscription.unsubscribe();
        }
    };
    Object.defineProperty(HasRoleDirective.prototype, "hasRole", {
        set: /**
         * @param {?} condition
         * @return {?}
         */
        function (condition) {
            this._context.$implicit = this._context.hasRole = condition;
            this._updateView();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HasRoleDirective.prototype, "hasRoleFactory", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._context.factory = value;
            this._updateView();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HasRoleDirective.prototype, "hasRoleThen", {
        set: /**
         * @param {?} templateRef
         * @return {?}
         */
        function (templateRef) {
            this._thenTemplateRef = templateRef;
            this._thenViewRef = null; // clear previous view if any.
            this._updateView();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HasRoleDirective.prototype, "hasRoleElse", {
        set: /**
         * @param {?} templateRef
         * @return {?}
         */
        function (templateRef) {
            this._elseTemplateRef = templateRef;
            this._elseViewRef = null; // clear previous view if any.
            this._updateView();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @private
     * @return {?}
     */
    HasRoleDirective.prototype._updateView = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var hasRole = false;
        if (this._context && this._context.$implicit) {
            if (typeof this._context.factory === 'string' && this._context.factory.length > 0) {
                hasRole = this.authorizationService.hasRoleForBoundary(this._context.$implicit, this._context.factory);
            }
            else {
                hasRole = this._context && this._context.$implicit && this.authorizationService.hasRole(this._context.$implicit);
            }
        }
        if (hasRole) {
            if (!this._thenViewRef) {
                this._viewContainer.clear();
                this._elseViewRef = null;
                if (this._thenTemplateRef) {
                    this._thenViewRef =
                        this._viewContainer.createEmbeddedView(this._thenTemplateRef, this._context);
                }
            }
        }
        else {
            if (!this._elseViewRef) {
                this._viewContainer.clear();
                this._thenViewRef = null;
                if (this._elseTemplateRef) {
                    this._elseViewRef =
                        this._viewContainer.createEmbeddedView(this._elseTemplateRef, this._context);
                }
            }
        }
    };
    HasRoleDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[appHasRole]'
                },] }
    ];
    /** @nocollapse */
    HasRoleDirective.ctorParameters = function () { return [
        { type: ViewContainerRef },
        { type: TemplateRef },
        { type: AuthenticationService },
        { type: AuthorizationService },
        { type: ChangeDetectorRef }
    ]; };
    HasRoleDirective.propDecorators = {
        hasRole: [{ type: Input }],
        hasRoleFactory: [{ type: Input }],
        hasRoleThen: [{ type: Input }],
        hasRoleElse: [{ type: Input }]
    };
    return HasRoleDirective;
}());
export { HasRoleDirective };
if (false) {
    /**
     * @type {?}
     * @private
     */
    HasRoleDirective.prototype._context;
    /**
     * @type {?}
     * @private
     */
    HasRoleDirective.prototype._thenTemplateRef;
    /**
     * @type {?}
     * @private
     */
    HasRoleDirective.prototype._elseTemplateRef;
    /**
     * @type {?}
     * @private
     */
    HasRoleDirective.prototype._thenViewRef;
    /**
     * @type {?}
     * @private
     */
    HasRoleDirective.prototype._elseViewRef;
    /**
     * @type {?}
     * @private
     */
    HasRoleDirective.prototype.loginEventsSubscription;
    /**
     * @type {?}
     * @private
     */
    HasRoleDirective.prototype._viewContainer;
    /**
     * @type {?}
     * @private
     */
    HasRoleDirective.prototype.authorizationService;
    /**
     * @type {?}
     * @private
     */
    HasRoleDirective.prototype.changeDetector;
}
var HasRoleContext = /** @class */ (function () {
    function HasRoleContext() {
        this.$implicit = null;
        this.hasRole = null;
        this.factory = null;
    }
    return HasRoleContext;
}());
export { HasRoleContext };
if (false) {
    /** @type {?} */
    HasRoleContext.prototype.$implicit;
    /** @type {?} */
    HasRoleContext.prototype.hasRole;
    /** @type {?} */
    HasRoleContext.prototype.factory;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFzLXJvbGUuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZ4LWxpYi9jb21wb25lbnRzLyIsInNvdXJjZXMiOlsibGliL2Z4LXNlY3VyaXR5L2RpcmVjdGl2ZXMvaGFzLXJvbGUuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsU0FBUyxFQUFtQixLQUFLLEVBQWEsV0FBVyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sZUFBZSxDQUFBO0FBRTlILE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLG9DQUFvQyxDQUFBO0FBQzFFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLG1DQUFtQyxDQUFBO0FBRXhFO0lBYUUsMEJBQW9CLGNBQWdDLEVBQ2xELFdBQXdDLEVBQ3hDLFdBQWtDLEVBQzFCLG9CQUEwQyxFQUMxQyxjQUFpQztRQUozQyxpQkFXQztRQVhtQixtQkFBYyxHQUFkLGNBQWMsQ0FBa0I7UUFHMUMseUJBQW9CLEdBQXBCLG9CQUFvQixDQUFzQjtRQUMxQyxtQkFBYyxHQUFkLGNBQWMsQ0FBbUI7UUFabkMsYUFBUSxHQUFtQixJQUFJLGNBQWMsRUFBRSxDQUFBO1FBQy9DLHFCQUFnQixHQUF1QyxJQUFJLENBQUE7UUFDM0QscUJBQWdCLEdBQXVDLElBQUksQ0FBQTtRQUMzRCxpQkFBWSxHQUEyQyxJQUFJLENBQUE7UUFDM0QsaUJBQVksR0FBMkMsSUFBSSxDQUFBO1FBU2pFLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxXQUFXLENBQUE7UUFFbkMsSUFBSSxDQUFDLHVCQUF1QixHQUFHLFdBQVcsQ0FBQyxXQUFXLENBQUMsU0FBUzs7O1FBQUM7WUFDL0QsS0FBSSxDQUFDLFdBQVcsRUFBRSxDQUFBO1lBQ2xCLEtBQUksQ0FBQyxjQUFjLENBQUMsWUFBWSxFQUFFLENBQUE7UUFDcEMsQ0FBQyxFQUFDLENBQUE7SUFDSixDQUFDOzs7O0lBRU0sc0NBQVc7OztJQUFsQjtRQUNF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QVMsU0FBQztvQkFDVCxRQUFRLEVBQUUsY0FBYztpQkFDekI7Ozs7Z0JBUHNGLGdCQUFnQjtnQkFBN0IsV0FBVztnQkFFNUUscUJBQXFCO2dCQUNyQixvQkFBb0I7Z0JBSHBCLGlCQUFpQjs7OzBCQXFDdkIsS0FBSztpQ0FNTCxLQUFLOzhCQU1MLEtBQUs7OEJBT0wsS0FBSzs7SUFvQ1IsdUJBQUM7Q0FBQSxBQXZGRCxJQXVGQztTQXBGWSxnQkFBZ0I7Ozs7OztJQUUzQixvQ0FBdUQ7Ozs7O0lBQ3ZELDRDQUFtRTs7Ozs7SUFDbkUsNENBQW1FOzs7OztJQUNuRSx3Q0FBbUU7Ozs7O0lBQ25FLHdDQUFtRTs7Ozs7SUFFbkUsbURBQTZDOzs7OztJQUVqQywwQ0FBd0M7Ozs7O0lBR2xELGdEQUFrRDs7Ozs7SUFDbEQsMENBQXlDOztBQXdFN0M7SUFBQTtRQUNTLGNBQVMsR0FBRyxJQUFJLENBQUE7UUFDaEIsWUFBTyxHQUFHLElBQUksQ0FBQTtRQUNkLFlBQU8sR0FBVyxJQUFJLENBQUE7SUFDL0IsQ0FBQztJQUFELHFCQUFDO0FBQUQsQ0FBQyxBQUpELElBSUM7Ozs7SUFIQyxtQ0FBdUI7O0lBQ3ZCLGlDQUFxQjs7SUFDckIsaUNBQTZCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hhbmdlRGV0ZWN0b3JSZWYsIERpcmVjdGl2ZSwgRW1iZWRkZWRWaWV3UmVmLCBJbnB1dCwgT25EZXN0cm95LCBUZW1wbGF0ZVJlZiwgVmlld0NvbnRhaW5lclJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnXHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnXHJcbmltcG9ydCB7IEF1dGhlbnRpY2F0aW9uU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2F1dGhlbnRpY2F0aW9uLnNlcnZpY2UnXHJcbmltcG9ydCB7IEF1dGhvcml6YXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvYXV0aG9yaXphdGlvbi5zZXJ2aWNlJ1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgc2VsZWN0b3I6ICdbYXBwSGFzUm9sZV0nXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBIYXNSb2xlRGlyZWN0aXZlIGltcGxlbWVudHMgT25EZXN0cm95IHtcclxuXHJcbiAgcHJpdmF0ZSBfY29udGV4dDogSGFzUm9sZUNvbnRleHQgPSBuZXcgSGFzUm9sZUNvbnRleHQoKVxyXG4gIHByaXZhdGUgX3RoZW5UZW1wbGF0ZVJlZjogVGVtcGxhdGVSZWY8SGFzUm9sZUNvbnRleHQ+IHwgbnVsbCA9IG51bGxcclxuICBwcml2YXRlIF9lbHNlVGVtcGxhdGVSZWY6IFRlbXBsYXRlUmVmPEhhc1JvbGVDb250ZXh0PiB8IG51bGwgPSBudWxsXHJcbiAgcHJpdmF0ZSBfdGhlblZpZXdSZWY6IEVtYmVkZGVkVmlld1JlZjxIYXNSb2xlQ29udGV4dD4gfCBudWxsID0gbnVsbFxyXG4gIHByaXZhdGUgX2Vsc2VWaWV3UmVmOiBFbWJlZGRlZFZpZXdSZWY8SGFzUm9sZUNvbnRleHQ+IHwgbnVsbCA9IG51bGxcclxuXHJcbiAgcHJpdmF0ZSBsb2dpbkV2ZW50c1N1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uXHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgX3ZpZXdDb250YWluZXI6IFZpZXdDb250YWluZXJSZWYsXHJcbiAgICB0ZW1wbGF0ZVJlZjogVGVtcGxhdGVSZWY8SGFzUm9sZUNvbnRleHQ+LFxyXG4gICAgYXV0aFNlcnZpY2U6IEF1dGhlbnRpY2F0aW9uU2VydmljZSxcclxuICAgIHByaXZhdGUgYXV0aG9yaXphdGlvblNlcnZpY2U6IEF1dGhvcml6YXRpb25TZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBjaGFuZ2VEZXRlY3RvcjogQ2hhbmdlRGV0ZWN0b3JSZWYpIHtcclxuICAgIHRoaXMuX3RoZW5UZW1wbGF0ZVJlZiA9IHRlbXBsYXRlUmVmXHJcblxyXG4gICAgdGhpcy5sb2dpbkV2ZW50c1N1YnNjcmlwdGlvbiA9IGF1dGhTZXJ2aWNlLmxvZ2luRXZlbnRzLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgIHRoaXMuX3VwZGF0ZVZpZXcoKVxyXG4gICAgICB0aGlzLmNoYW5nZURldGVjdG9yLm1hcmtGb3JDaGVjaygpXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgcHVibGljIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMubG9naW5FdmVudHNTdWJzY3JpcHRpb24pIHtcclxuICAgICAgdGhpcy5sb2dpbkV2ZW50c1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCBoYXNSb2xlKGNvbmRpdGlvbjogYW55KSB7XHJcbiAgICB0aGlzLl9jb250ZXh0LiRpbXBsaWNpdCA9IHRoaXMuX2NvbnRleHQuaGFzUm9sZSA9IGNvbmRpdGlvblxyXG4gICAgdGhpcy5fdXBkYXRlVmlldygpXHJcbiAgfVxyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCBoYXNSb2xlRmFjdG9yeSh2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLl9jb250ZXh0LmZhY3RvcnkgPSB2YWx1ZVxyXG4gICAgdGhpcy5fdXBkYXRlVmlldygpXHJcbiAgfVxyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCBoYXNSb2xlVGhlbih0ZW1wbGF0ZVJlZjogVGVtcGxhdGVSZWY8SGFzUm9sZUNvbnRleHQ+KSB7XHJcbiAgICB0aGlzLl90aGVuVGVtcGxhdGVSZWYgPSB0ZW1wbGF0ZVJlZlxyXG4gICAgdGhpcy5fdGhlblZpZXdSZWYgPSBudWxsICAvLyBjbGVhciBwcmV2aW91cyB2aWV3IGlmIGFueS5cclxuICAgIHRoaXMuX3VwZGF0ZVZpZXcoKVxyXG4gIH1cclxuXHJcbiAgQElucHV0KClcclxuICBzZXQgaGFzUm9sZUVsc2UodGVtcGxhdGVSZWY6IFRlbXBsYXRlUmVmPEhhc1JvbGVDb250ZXh0Pikge1xyXG4gICAgdGhpcy5fZWxzZVRlbXBsYXRlUmVmID0gdGVtcGxhdGVSZWZcclxuICAgIHRoaXMuX2Vsc2VWaWV3UmVmID0gbnVsbCAgLy8gY2xlYXIgcHJldmlvdXMgdmlldyBpZiBhbnkuXHJcbiAgICB0aGlzLl91cGRhdGVWaWV3KClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgX3VwZGF0ZVZpZXcoKTogdm9pZCB7XHJcbiAgICBsZXQgaGFzUm9sZSA9IGZhbHNlXHJcbiAgICBpZiAodGhpcy5fY29udGV4dCAmJiB0aGlzLl9jb250ZXh0LiRpbXBsaWNpdCkge1xyXG4gICAgICBpZiAodHlwZW9mIHRoaXMuX2NvbnRleHQuZmFjdG9yeSA9PT0gJ3N0cmluZycgJiYgdGhpcy5fY29udGV4dC5mYWN0b3J5Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICBoYXNSb2xlID0gdGhpcy5hdXRob3JpemF0aW9uU2VydmljZS5oYXNSb2xlRm9yQm91bmRhcnkodGhpcy5fY29udGV4dC4kaW1wbGljaXQsIHRoaXMuX2NvbnRleHQuZmFjdG9yeSlcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBoYXNSb2xlID0gdGhpcy5fY29udGV4dCAmJiB0aGlzLl9jb250ZXh0LiRpbXBsaWNpdCAmJiB0aGlzLmF1dGhvcml6YXRpb25TZXJ2aWNlLmhhc1JvbGUodGhpcy5fY29udGV4dC4kaW1wbGljaXQpXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChoYXNSb2xlKSB7XHJcbiAgICAgIGlmICghdGhpcy5fdGhlblZpZXdSZWYpIHtcclxuICAgICAgICB0aGlzLl92aWV3Q29udGFpbmVyLmNsZWFyKClcclxuICAgICAgICB0aGlzLl9lbHNlVmlld1JlZiA9IG51bGxcclxuICAgICAgICBpZiAodGhpcy5fdGhlblRlbXBsYXRlUmVmKSB7XHJcbiAgICAgICAgICB0aGlzLl90aGVuVmlld1JlZiA9XHJcbiAgICAgICAgICAgIHRoaXMuX3ZpZXdDb250YWluZXIuY3JlYXRlRW1iZWRkZWRWaWV3KHRoaXMuX3RoZW5UZW1wbGF0ZVJlZiwgdGhpcy5fY29udGV4dClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGlmICghdGhpcy5fZWxzZVZpZXdSZWYpIHtcclxuICAgICAgICB0aGlzLl92aWV3Q29udGFpbmVyLmNsZWFyKClcclxuICAgICAgICB0aGlzLl90aGVuVmlld1JlZiA9IG51bGxcclxuICAgICAgICBpZiAodGhpcy5fZWxzZVRlbXBsYXRlUmVmKSB7XHJcbiAgICAgICAgICB0aGlzLl9lbHNlVmlld1JlZiA9XHJcbiAgICAgICAgICAgIHRoaXMuX3ZpZXdDb250YWluZXIuY3JlYXRlRW1iZWRkZWRWaWV3KHRoaXMuX2Vsc2VUZW1wbGF0ZVJlZiwgdGhpcy5fY29udGV4dClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBIYXNSb2xlQ29udGV4dCB7XHJcbiAgcHVibGljICRpbXBsaWNpdCA9IG51bGxcclxuICBwdWJsaWMgaGFzUm9sZSA9IG51bGxcclxuICBwdWJsaWMgZmFjdG9yeTogc3RyaW5nID0gbnVsbFxyXG59XHJcbiJdfQ==